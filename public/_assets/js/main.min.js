function Timemap(e){"use strict";function t(e){return e.replace(/Y/,a).replace(/y/,a.toString().substr(2,3)).replace(/mm/,o+1).replace(/MM/,o.toString().length>1?o+1:"0"+(o+1)).replace(/M/,i[o]).replace(/m/,i[o].toString().substr(0,3)).replace(/dd/,r).replace(/DD/,r.toString().length>1?r:"0"+r).replace(/d/,l[n].toString().substr(0,3)).replace(/D/,l[n])}var e=e||new Date,o=e.getMonth(),r=e.getDate(),n=e.getDay(),a=e.getFullYear(),i=(e.getTime(),e.getHours(),e.getMinutes(),e.getSeconds(),["January","February","March","April","May","June","July","August","September","October","November","December"]),l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return{date:e,format:t}}!function(){for(var e=0,t=["webkit","moz"],o=0;o<t.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[t[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[o]+"CancelAnimationFrame"]||window[t[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,o){var r=(new Date).getTime(),n=Math.max(0,16-(r-e)),a=window.setTimeout(function(){t(r+n)},n);return e=r+n,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(){for(var e,t=function(){},o=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],r=o.length,n=window.console=window.console||{};r--;)e=o[r],n[e]||(n[e]=t)}(),"undefined"!=typeof module&&module.exports&&(module.exports=Timemap);var kickback=function(e){"use strict";function t(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t.join("&")}return e={},e.request=function(e){if("string"==typeof e){var o=e;e={},e.url=o,o=null}if(e.url=e.url?e.url:"/",e.data=e.data?e.data:null,e.method=e.method?e.method:"GET",e.headers=e.headers?e.headers:!1,e.cors=e.cors?e.cors:!1,e.async=e.async?e.async:!0,e.serialize=e.serialize?e.serialize:!1,e.auto=e.auto?e.auto:!1,Object.defineProperty(e,"tmp",{configurable:!0,writable:!0}),e.auto===!0)if("undefined"!=typeof window.FormData)if(e.data instanceof HTMLElement)e.data=new FormData(e.data);else{if("object"!=typeof e.data||e.data instanceof Array!=!1)throw new Error("Submit data as object or HTMLElement");e.tmp=e.data,e.data=new FormData,Object.keys(e.tmp).forEach(function(t){e.data.append(t,e.tmp[t])}),delete e.tmp}else e.data instanceof HTMLElement&&(e.tmp={},[].forEach.call(e.data,function(t){e.tmp[t.name]=t.value}),e.data=e.tmp,delete e.tmp),e.serialize=!0;return e.serialize===!0&&(e.data=t(e.data)),console.log(e.data instanceof FormData?"formDATA":"notFormData"),new Promise(function(t,o){var r=new XMLHttpRequest;r.open(e.method,e.url,e.async),r.onload=function(){200==r.status?t(r.response):o(Error("Error: ",r.statusTxt))},r.onerror=function(){o(Error("Network Error"))},e.headers!==!1&&(e.headers.type=e.headers.type||"Content-Type",e.headers.value=e.headers.value||"text/plain;charset=UTF-8",r.setRequestHeader(e.headers.type,e.headers.value)),e.headers===!1&&"post"===e.method.toLowerCase()&&e.serialize===!0&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send("get"===e.method.toLowerCase()?null:e.data)})},e}(kickback);"undefined"!=typeof module&&module.exports&&(module.exports=kickback),function(e){"use strict";function t(){i=e.scrollY,console.log("set cache Y",i)}function o(){console.log("scrolling stopped")}function r(t){"string"==typeof t&&(t=document.querySelector(t));var o=t.getBoundingClientRect();return o.top>e.innerHeight||o.bottom<0?(console.log(t,"is NOT in view"),t.classList.contains("in-view")&&t.classList.remove("in-view"),!1):(console.log(t,"is in view"),t.classList.add("in-view"),!0)}var n=null,a=null,i=0,l=(document.querySelector('ul[role="menubar"]'),document.getElementById("main-nav")),s=document.getElementById("masthead"),c=["#about","#work","#projects"],u="#eaeaea",d="#AFB4D8",m="#6F94BE",f="#6EAEB3",p="#66CF97",g="#49DB45",w="#1DE410";e.onscroll=function(y){null!=n&&clearTimeout(n),null!=a&&clearTimeout(a),i<e.scrollY&&l.classList.add("hide-nav"),i>e.scrollY&&l.classList.remove("hide-nav"),n=setTimeout(o,1500),a=setTimeout(t,100),0==e.scrollY&&(s.style.backgroundColor=u),e.scrollY>0&&e.scrollY<=20&&(s.style.backgroundColor=d),e.scrollY>=21&&e.scrollY<=40&&(s.style.backgroundColor=m),e.scrollY>=41&&e.scrollY<=60&&(s.style.backgroundColor=f),e.scrollY>=61&&e.scrollY<=80&&(s.style.backgroundColor=p),e.scrollY>=81&&e.scrollY<=100&&(s.style.backgroundColor=g),e.scrollY>=101&&e.scrollY<=120&&(s.style.backgroundColor=w),e.scrollY>=121&&(s.style.backgroundColor=u),c.forEach(function(e){r(e)})}}(window),function(){"use strict";var e=function(e,t,o){var r,n,a=window.pageYOffset,i=e.offsetTop,l=i-a,s=l/(t/16);o>0&&(i-=o);var c=function(){window.scrollBy(0,s),n=window.pageYOffset,r=requestAnimationFrame(c),s>=0?(n>=i-s||window.innerHeight+n>=document.body.offsetHeight)&&cancelAnimationFrame(r):(i||0)>=n&&cancelAnimationFrame(r)};r=requestAnimationFrame(c)};document.addEventListener("click",function(t){if(t.target&&"A"==t.target.nodeName&&t.target.classList.contains("scroll")){t.preventDefault();var o=t.target.getAttribute("href"),r=document.querySelector(o),n=t.target.getAttribute("data-scroll-speed")?t.target.getAttribute("data-scroll-speed"):500,a=t.target.getAttribute("data-scroll-offset")?t.target.getAttribute("data-scroll-offset"):!1;r&&e(r,n,a)}},!1)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRpbWVtYXAuanMiLCJwb2x5ZmlsbHMuanMiLCJwbHVnaW5zLmpzIiwia2lja2JhY2suanMiLCJzY3JvbGxhYmxlcy5qcyIsInNtb290aC1zY3JvbGwuanMiXSwibmFtZXMiOlsiVGltZW1hcCIsImRhdGVPYmoiLCJmb3JtYXQiLCJzdHIiLCJyZXBsYWNlIiwieWVhciIsInRvU3RyaW5nIiwic3Vic3RyIiwibW9udGgiLCJsZW5ndGgiLCJtb250aHMiLCJkYXkiLCJkYXlzIiwiZGF5T2ZXZWVrIiwiRGF0ZSIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldERheSIsImdldEZ1bGxZZWFyIiwiZ2V0VGltZSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsImdldFNlY29uZHMiLCJkYXRlIiwibGFzdFRpbWUiLCJ2ZW5kb3JzIiwieCIsIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiY2FsbGJhY2siLCJlbGVtZW50IiwiY3VyclRpbWUiLCJ0aW1lVG9DYWxsIiwiTWF0aCIsIm1heCIsImlkIiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsIm1ldGhvZCIsIm5vb3AiLCJtZXRob2RzIiwiY29uc29sZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJraWNrYmFjayIsIl9zZXJpYWxpemUiLCJvYmoiLCJwIiwiaGFzT3duUHJvcGVydHkiLCJwdXNoIiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwiam9pbiIsInJlcXVlc3QiLCJrYk9wdGlvbnMiLCJ0bXAiLCJ1cmwiLCJkYXRhIiwiaGVhZGVycyIsImNvcnMiLCJhc3luYyIsInNlcmlhbGl6ZSIsImF1dG8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiRm9ybURhdGEiLCJIVE1MRWxlbWVudCIsIkFycmF5IiwiRXJyb3IiLCJrZXlzIiwiZm9yRWFjaCIsImtleSIsImFwcGVuZCIsImNhbGwiLCJlbGVtIiwibmFtZSIsInZhbHVlIiwibG9nIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJvbmxvYWQiLCJzdGF0dXMiLCJyZXNwb25zZSIsInN0YXR1c1R4dCIsIm9uZXJyb3IiLCJ0eXBlIiwic2V0UmVxdWVzdEhlYWRlciIsInRvTG93ZXJDYXNlIiwic2VuZCIsInNjcm9sbFNldENhY2hlZCIsImNhY2hlU2Nyb2xsUG9zIiwic2Nyb2xsWSIsImhhbmRsZVNjcm9sbCIsImlzRWxlbWVudFZpc2libGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwidG9wIiwiaW5uZXJIZWlnaHQiLCJib3R0b20iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInJlbW92ZSIsImFkZCIsInNjcm9sbFRpbWVyIiwic2Nyb2xsQ2FjaGVUaW1lciIsIm1lbnViYXIiLCJnZXRFbGVtZW50QnlJZCIsIm1hc3RoZWFkIiwic2VjdGlvbnMiLCJpbml0aWFsQkdDb2xvciIsImJHQ29sb3JfMSIsImJHQ29sb3JfMiIsImJHQ29sb3JfMyIsImJHQ29sb3JfNCIsImJHQ29sb3JfNSIsImJHQ29sb3JfNiIsIm9uc2Nyb2xsIiwiZSIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwic21vb3RoU2Nyb2xsIiwiYW5jaG9yIiwiZHVyYXRpb24iLCJvZmZzZXQiLCJydW5BbmltYXRpb24iLCJ0cmF2ZWxsZWQiLCJzdGFydExvY2F0aW9uIiwicGFnZVlPZmZzZXQiLCJlbmRMb2NhdGlvbiIsIm9mZnNldFRvcCIsImRpc3RhbmNlIiwiaW5jcmVtZW50cyIsImFuaW1hdGVTY3JvbGwiLCJzY3JvbGxCeSIsImJvZHkiLCJvZmZzZXRIZWlnaHQiLCJhZGRFdmVudExpc3RlbmVyIiwidGFyZ2V0Iiwibm9kZU5hbWUiLCJwcmV2ZW50RGVmYXVsdCIsImRhdGFJRCIsImdldEF0dHJpYnV0ZSIsImRhdGFUYXJnZXQiLCJkYXRhU3BlZWQiLCJkYXRhT2Zmc2V0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QUFXLE1BQUFDLGdCQUFBVixHQUVBRCxFQUFBNUMsUUFBQSxTQUFBSSxHQUNBdUIsRUFBQXZCLE9BSUFqRCxRQ3pGQSxXQUVBLFlBR0EsSUFBQXFHLEdBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FHQSxHQUlBQyxHQUFBQyxFQUpBQyxFQUFBM0csT0FBQTRHLFlBQ0FDLEVBQUFQLEVBQUFRLFVBQ0FDLEVBQUFGLEVBQUFGLEVBQ0FLLEVBQUFELEdBQUFSLEVBQUEsR0FHQUMsR0FBQSxJQUNBSyxHQUFBTCxFQUlBLElBQUFTLEdBQUEsV0FDQWpILE9BQUFrSCxTQUFBLEVBQUFGLEdBQ0FOLEVBQUExRyxPQUFBNEcsWUFFQUgsRUFBQXhHLHNCQUFBZ0gsR0FHQUQsR0FBQSxHQUVBTixHQUFBRyxFQUFBRyxHQUFBaEgsT0FBQThFLFlBQUE0QixHQUFBakMsU0FBQTBDLEtBQUFDLGVBQ0FsSCxxQkFBQXVHLElBTUFJLEdBQUEsSUFBQUgsR0FDQXhHLHFCQUFBdUcsR0FNQUEsR0FBQXhHLHNCQUFBZ0gsR0FLQXhDLFVBQUE0QyxpQkFBQSxRQUFBLFNBQUFuQixHQUVBLEdBQUFBLEVBQUFvQixRQUFBLEtBQUFwQixFQUFBb0IsT0FBQUMsVUFDQXJCLEVBQUFvQixPQUFBdEMsVUFBQUMsU0FBQSxVQUFBLENBQ0FpQixFQUFBc0IsZ0JBR0EsSUFBQUMsR0FBQXZCLEVBQUFvQixPQUFBSSxhQUFBLFFBQ0FDLEVBQUFsRCxTQUFBQyxjQUFBK0MsR0FDQUcsRUFBQTFCLEVBQUFvQixPQUFBSSxhQUFBLHFCQUFBeEIsRUFBQW9CLE9BQUFJLGFBQUEscUJBQUEsSUFDQUcsRUFBQTNCLEVBQUFvQixPQUFBSSxhQUFBLHNCQUFBeEIsRUFBQW9CLE9BQUFJLGFBQUEsdUJBQUEsQ0FHQUMsSUFFQXRCLEVBQUFzQixFQUFBQyxFQUFBQyxNQUtBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gVGltZW1hcChkYXRlT2JqKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGRhdGVPYmogPSBkYXRlT2JqIHx8IG5ldyBEYXRlKCksXG4gICAgbW9udGggPSBkYXRlT2JqLmdldE1vbnRoKCksIC8vIGN1cyBqYXZhc2NyaXB0IHN0YXJ0cyBtb250aCBhdCAwXG4gICAgZGF5ID0gZGF0ZU9iai5nZXREYXRlKCksXG4gICAgZGF5T2ZXZWVrID0gZGF0ZU9iai5nZXREYXkoKSxcbiAgICB5ZWFyID0gZGF0ZU9iai5nZXRGdWxsWWVhcigpLFxuICAgIHRpbWUgPSBkYXRlT2JqLmdldFRpbWUoKSxcbiAgICBob3VyID0gZGF0ZU9iai5nZXRIb3VycygpLFxuICAgIG1pbnV0ZXMgPSBkYXRlT2JqLmdldE1pbnV0ZXMoKSxcbiAgICBzZWNvbmRzID0gZGF0ZU9iai5nZXRTZWNvbmRzKCk7XG5cbiAgICB2YXIgbW9udGhzID0gW1xuICAgICAgICAnSmFudWFyeScsXG4gICAgICAgICdGZWJydWFyeScsXG4gICAgICAgICdNYXJjaCcsXG4gICAgICAgICdBcHJpbCcsXG4gICAgICAgICdNYXknLFxuICAgICAgICAnSnVuZScsXG4gICAgICAgICdKdWx5JyxcbiAgICAgICAgJ0F1Z3VzdCcsXG4gICAgICAgICdTZXB0ZW1iZXInLFxuICAgICAgICAnT2N0b2JlcicsXG4gICAgICAgICdOb3ZlbWJlcicsXG4gICAgICAgICdEZWNlbWJlcidcbiAgICBdO1xuXG4gICAgdmFyIGRheXMgPSBbXG4gICAgICAgICdTdW5kYXknLFxuICAgICAgICAnTW9uZGF5JyxcbiAgICAgICAgJ1R1ZXNkYXknLFxuICAgICAgICAnV2VkbmVzZGF5JyxcbiAgICAgICAgJ1RodXJzZGF5JyxcbiAgICAgICAgJ0ZyaWRheScsXG4gICAgICAgICdTYXR1cmRheSdcbiAgICBdO1xuXG4gICAgZnVuY3Rpb24gZm9ybWF0KHN0cikge1xuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1kvLCB5ZWFyKSAvLyAyMDE1XG4gICAgICAgIC5yZXBsYWNlKC95LywgeWVhci50b1N0cmluZygpLnN1YnN0cigyLDMpKSAvLzE1XG4gICAgICAgIC5yZXBsYWNlKC9tbS8sIG1vbnRoKzEpIC8vNSwgOSwgMTFcbiAgICAgICAgLnJlcGxhY2UoL01NLywgKG1vbnRoLnRvU3RyaW5nKCkubGVuZ3RoID4gMSkgPyBtb250aCArIDEgOiAnMCcrKG1vbnRoKzEpKSAvLyAwNSwgMDksIDExXG4gICAgICAgIC5yZXBsYWNlKC9NLywgbW9udGhzW21vbnRoXSkgLy8gSmFudWFyeSwgTWFyY2gsIEp1bmVcbiAgICAgICAgLnJlcGxhY2UoL20vLCBtb250aHNbbW9udGhdLnRvU3RyaW5nKCkuc3Vic3RyKDAsMykpIC8vIEphbiwgTWFyLCBKdW5cbiAgICAgICAgLnJlcGxhY2UoL2RkLywgZGF5KSAvLyAxLCA1LCAyMCwgMjZcbiAgICAgICAgLnJlcGxhY2UoL0RELywgKGRheS50b1N0cmluZygpLmxlbmd0aCA+IDEpID8gZGF5IDogJzAnK2RheSkgLy8gMDEsIDA0LCAxNSwgMjJcbiAgICAgICAgLnJlcGxhY2UoL2QvLCBkYXlzW2RheU9mV2Vla10udG9TdHJpbmcoKS5zdWJzdHIoMCwzKSkgLy8gTW9uLCBUdWVcbiAgICAgICAgLnJlcGxhY2UoL0QvLCBkYXlzW2RheU9mV2Vla10pOyAvLyBNb25kYXksIFR1ZXNkYXlcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGF0ZTogZGF0ZU9iaixcbiAgICAgICAgZm9ybWF0OiBmb3JtYXRcbiAgICB9O1xufTtcblxuaWYodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFRpbWVtYXA7XG59XG4iLCIvLyBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgUG9seWZpbGxcbihmdW5jdGlvbigpIHtcbiAgICB2YXIgbGFzdFRpbWUgPSAwO1xuICAgIHZhciB2ZW5kb3JzID0gWyd3ZWJraXQnLCAnbW96J107XG4gICAgZm9yKHZhciB4ID0gMDsgeCA8IHZlbmRvcnMubGVuZ3RoICYmICF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lOyArK3gpIHtcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvd1t2ZW5kb3JzW3hdKydSZXF1ZXN0QW5pbWF0aW9uRnJhbWUnXTtcbiAgICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lID1cbiAgICAgICAgICB3aW5kb3dbdmVuZG9yc1t4XSsnQ2FuY2VsQW5pbWF0aW9uRnJhbWUnXSB8fCB3aW5kb3dbdmVuZG9yc1t4XSsnQ2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lJ107XG4gICAgfVxuXG4gICAgaWYgKCF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKVxuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24oY2FsbGJhY2ssIGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciBjdXJyVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICAgICAgdmFyIHRpbWVUb0NhbGwgPSBNYXRoLm1heCgwLCAxNiAtIChjdXJyVGltZSAtIGxhc3RUaW1lKSk7XG4gICAgICAgICAgICB2YXIgaWQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsgY2FsbGJhY2soY3VyclRpbWUgKyB0aW1lVG9DYWxsKTsgfSxcbiAgICAgICAgICAgICAgdGltZVRvQ2FsbCk7XG4gICAgICAgICAgICBsYXN0VGltZSA9IGN1cnJUaW1lICsgdGltZVRvQ2FsbDtcbiAgICAgICAgICAgIHJldHVybiBpZDtcbiAgICAgICAgfTtcblxuICAgIGlmICghd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKVxuICAgICAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGlkKTtcbiAgICAgICAgfTtcbn0oKSk7XG4iLCIvLyBBdm9pZCBgY29uc29sZWAgZXJyb3JzIGluIGJyb3dzZXJzIHRoYXQgbGFjayBhIGNvbnNvbGUuXG4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIG1ldGhvZDtcbiAgICB2YXIgbm9vcCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgIHZhciBtZXRob2RzID0gW1xuICAgICAgICAnYXNzZXJ0JywgJ2NsZWFyJywgJ2NvdW50JywgJ2RlYnVnJywgJ2RpcicsICdkaXJ4bWwnLCAnZXJyb3InLFxuICAgICAgICAnZXhjZXB0aW9uJywgJ2dyb3VwJywgJ2dyb3VwQ29sbGFwc2VkJywgJ2dyb3VwRW5kJywgJ2luZm8nLCAnbG9nJyxcbiAgICAgICAgJ21hcmtUaW1lbGluZScsICdwcm9maWxlJywgJ3Byb2ZpbGVFbmQnLCAndGFibGUnLCAndGltZScsICd0aW1lRW5kJyxcbiAgICAgICAgJ3RpbWVsaW5lJywgJ3RpbWVsaW5lRW5kJywgJ3RpbWVTdGFtcCcsICd0cmFjZScsICd3YXJuJ1xuICAgIF07XG4gICAgdmFyIGxlbmd0aCA9IG1ldGhvZHMubGVuZ3RoO1xuICAgIHZhciBjb25zb2xlID0gKHdpbmRvdy5jb25zb2xlID0gd2luZG93LmNvbnNvbGUgfHwge30pO1xuXG4gICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIG1ldGhvZCA9IG1ldGhvZHNbbGVuZ3RoXTtcblxuICAgICAgICAvLyBPbmx5IHN0dWIgdW5kZWZpbmVkIG1ldGhvZHMuXG4gICAgICAgIGlmICghY29uc29sZVttZXRob2RdKSB7XG4gICAgICAgICAgICBjb25zb2xlW21ldGhvZF0gPSBub29wO1xuICAgICAgICB9XG4gICAgfVxufSgpKTtcbiIsInZhciBraWNrYmFjayA9IChmdW5jdGlvbihraWNrYmFjaykge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvLyBtYWtlIGEgbmV3IG9iamVjdFxuICAgIGtpY2tiYWNrID0ge307XG5cbiAgICAvLyBwcml2YXRlIG1ldGhvZFxuICAgIGZ1bmN0aW9uIF9zZXJpYWxpemUob2JqKSB7XG4gICAgICAgIHZhciBzdHIgPSBbXTtcbiAgICAgICAgZm9yKHZhciBwIGluIG9iail7XG4gICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KHApKSB7XG4gICAgICAgICAgICAgICAgc3RyLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KHApICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQob2JqW3BdKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0ci5qb2luKFwiJlwiKTtcbiAgICB9O1xuXG4gICAgLy8gbWFpbiBwdWJsaWMgbWV0aG9kXG4gICAga2lja2JhY2sucmVxdWVzdCA9IGZ1bmN0aW9uKGtiT3B0aW9ucykge1xuICAgICAgICAvLyBvcHRpb25zIGNvbmZpZ3VyYXRpb24gYW5kIGRlZmF1bHRzXG4gICAgICAgIGlmKHR5cGVvZiBrYk9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAvLyBhc3N1bWUgaXQncyBhIHVybCBhbmQgd2UgYXJlIHVzaW5nIEdFVCBcbiAgICAgICAgICAgIHZhciB0bXAgPSBrYk9wdGlvbnM7XG4gICAgICAgICAgICBrYk9wdGlvbnMgPSB7fTtcbiAgICAgICAgICAgIGtiT3B0aW9ucy51cmwgPSB0bXA7XG4gICAgICAgICAgICB0bXAgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAga2JPcHRpb25zLnVybCA9IChrYk9wdGlvbnMudXJsKSA/IGtiT3B0aW9ucy51cmwgOiAnLyc7XG4gICAgICAgIGtiT3B0aW9ucy5kYXRhID0gKGtiT3B0aW9ucy5kYXRhKSA/IGtiT3B0aW9ucy5kYXRhIDogbnVsbDtcbiAgICAgICAga2JPcHRpb25zLm1ldGhvZCA9IChrYk9wdGlvbnMubWV0aG9kKSA/IGtiT3B0aW9ucy5tZXRob2QgOiAnR0VUJztcbiAgICAgICAga2JPcHRpb25zLmhlYWRlcnMgPSAoa2JPcHRpb25zLmhlYWRlcnMpID8ga2JPcHRpb25zLmhlYWRlcnMgOiBmYWxzZTtcbiAgICAgICAga2JPcHRpb25zLmNvcnMgPSAoa2JPcHRpb25zLmNvcnMpID8ga2JPcHRpb25zLmNvcnMgOiBmYWxzZTtcbiAgICAgICAga2JPcHRpb25zLmFzeW5jID0gKGtiT3B0aW9ucy5hc3luYykgPyBrYk9wdGlvbnMuYXN5bmMgOiB0cnVlO1xuICAgICAgICBrYk9wdGlvbnMuc2VyaWFsaXplID0gKGtiT3B0aW9ucy5zZXJpYWxpemUpID8ga2JPcHRpb25zLnNlcmlhbGl6ZSA6IGZhbHNlO1xuICAgICAgICBrYk9wdGlvbnMuYXV0byA9IChrYk9wdGlvbnMuYXV0bykgPyBrYk9wdGlvbnMuYXV0byA6IGZhbHNlOyBcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGtiT3B0aW9ucywgJ3RtcCcsIHtcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmKGtiT3B0aW9ucy5hdXRvID09PSB0cnVlKSB7XG4gICAgICAgICAgICBpZih0eXBlb2Ygd2luZG93LkZvcm1EYXRhICE9PSAndW5kZWZpbmVkJykgeyBcbiAgICAgICAgICAgICAgICBpZihrYk9wdGlvbnMuZGF0YSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGtiT3B0aW9ucy5kYXRhID0gbmV3IEZvcm1EYXRhKGtiT3B0aW9ucy5kYXRhKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBrYk9wdGlvbnMuZGF0YSA9PT0gJ29iamVjdCcgJiYga2JPcHRpb25zLmRhdGEgaW5zdGFuY2VvZiBBcnJheSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAga2JPcHRpb25zLnRtcCA9IGtiT3B0aW9ucy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBrYk9wdGlvbnMuZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhrYk9wdGlvbnMudG1wKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAga2JPcHRpb25zLmRhdGEuYXBwZW5kKGtleSwga2JPcHRpb25zLnRtcFtrZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBrYk9wdGlvbnMudG1wO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU3VibWl0IGRhdGEgYXMgb2JqZWN0IG9yIEhUTUxFbGVtZW50Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZihrYk9wdGlvbnMuZGF0YSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGtiT3B0aW9ucy50bXAgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKGtiT3B0aW9ucy5kYXRhLCBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrYk9wdGlvbnMudG1wW2VsZW0ubmFtZV0gPSBlbGVtLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAga2JPcHRpb25zLmRhdGEgPSBrYk9wdGlvbnMudG1wO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUga2JPcHRpb25zLnRtcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAga2JPcHRpb25zLnNlcmlhbGl6ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZihrYk9wdGlvbnMuc2VyaWFsaXplID09PSB0cnVlKSB7XG4gICAgICAgICAgICBrYk9wdGlvbnMuZGF0YSA9IF9zZXJpYWxpemUoa2JPcHRpb25zLmRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoa2JPcHRpb25zLmRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Zvcm1EQVRBJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbm90Rm9ybURhdGEnKTtcbiAgICAgICAgfSBcblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICB4aHIub3BlbihrYk9wdGlvbnMubWV0aG9kLCBrYk9wdGlvbnMudXJsLCBrYk9wdGlvbnMuYXN5bmMpO1xuXG4gICAgICAgICAgICAvLyBjaGVjayBzdGF0dXNcbiAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZih4aHIuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KEVycm9yKCdFcnJvcjogJywgeGhyLnN0YXR1c1R4dCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIG5ldHdvcmsgZXJyb3JcbiAgICAgICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KEVycm9yKCdOZXR3b3JrIEVycm9yJykpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gc2V0IGhlYWRlcnNcbiAgICAgICAgICAgIGlmKGtiT3B0aW9ucy5oZWFkZXJzICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGtiT3B0aW9ucy5oZWFkZXJzLnR5cGUgPSBrYk9wdGlvbnMuaGVhZGVycy50eXBlIHx8ICdDb250ZW50LVR5cGUnO1xuICAgICAgICAgICAgICAgIGtiT3B0aW9ucy5oZWFkZXJzLnZhbHVlID0ga2JPcHRpb25zLmhlYWRlcnMudmFsdWUgfHwgJ3RleHQvcGxhaW47Y2hhcnNldD1VVEYtOCc7XG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2JPcHRpb25zLmhlYWRlcnMudHlwZSwga2JPcHRpb25zLmhlYWRlcnMudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZihrYk9wdGlvbnMuaGVhZGVycyA9PT0gZmFsc2UgJiYga2JPcHRpb25zLm1ldGhvZC50b0xvd2VyQ2FzZSgpID09PSAncG9zdCcgJiYga2JPcHRpb25zLnNlcmlhbGl6ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBtYWtlIHRoZSByZXF1ZXN0XG4gICAgICAgICAgICBpZihrYk9wdGlvbnMubWV0aG9kLnRvTG93ZXJDYXNlKCkgPT09ICdnZXQnKSB7XG4gICAgICAgICAgICAgICAgeGhyLnNlbmQobnVsbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHhoci5zZW5kKGtiT3B0aW9ucy5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTsgLy8gZW5kIG1haW4gbWV0aG9kXG5cblxuICAgIHJldHVybiBraWNrYmFjaztcblxufShraWNrYmFjaykpO1xuXG4vLyBzZWUgaWYgd2UgYXJlIGluIG5vZGUgaWYgc28gc3VwcG9ydCBpdCFcbmlmKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBraWNrYmFjaztcbn1cbiIsIihmdW5jdGlvbih3aW5kb3cpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgc2Nyb2xsVGltZXIgPSBudWxsLFxuICAgICAgICBzY3JvbGxDYWNoZVRpbWVyID0gbnVsbCxcbiAgICAgICAgY2FjaGVTY3JvbGxQb3MgPSAwO1xuXG4gICAgdmFyIG5hdm1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bFtyb2xlPVwibWVudWJhclwiXScpLFxuICAgICAgICBtZW51YmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4tbmF2JyksXG4gICAgICAgIG1hc3RoZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hc3RoZWFkJyk7XG5cbiAgICB2YXIgc2VjdGlvbnMgPSBbXG4gICAgICAgICAgICAnI2Fib3V0JyxcbiAgICAgICAgICAgICcjd29yaycsXG4gICAgICAgICAgICAnI3Byb2plY3RzJ1xuICAgICAgICBdO1xuXG4gICAgdmFyIGluaXRpYWxCR0NvbG9yID0gJyNlYWVhZWEnLFxuICAgICAgICBiR0NvbG9yXzEgPSAnI0FGQjREOCcsXG4gICAgICAgIGJHQ29sb3JfMiA9ICcjNkY5NEJFJyxcbiAgICAgICAgYkdDb2xvcl8zID0gJyM2RUFFQjMnLFxuICAgICAgICBiR0NvbG9yXzQgPSAnIzY2Q0Y5NycsXG4gICAgICAgIGJHQ29sb3JfNSA9ICcjNDlEQjQ1JyxcbiAgICAgICAgYkdDb2xvcl82ID0gJyMxREU0MTAnO1xuXG4gICAgZnVuY3Rpb24gc2Nyb2xsU2V0Q2FjaGVkKCkge1xuICAgICAgICBjYWNoZVNjcm9sbFBvcyA9IHdpbmRvdy5zY3JvbGxZO1xuICAgICAgICBjb25zb2xlLmxvZygnc2V0IGNhY2hlIFknLCBjYWNoZVNjcm9sbFBvcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlU2Nyb2xsKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnc2Nyb2xsaW5nIHN0b3BwZWQnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0VsZW1lbnRWaXNpYmxlKGVsZW0pIHtcbiAgICAgICAgaWYodHlwZW9mIGVsZW0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFyIHJlY3QgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBcbiAgICAgICAgaWYocmVjdC50b3AgPiB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgcmVjdC5ib3R0b20gPCAwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlbGVtLCAnaXMgTk9UIGluIHZpZXcnKTtcbiAgICAgICAgICAgIGlmKGVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdpbi12aWV3JykpIHtcbiAgICAgICAgICAgICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2luLXZpZXcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVsZW0sICdpcyBpbiB2aWV3Jyk7XG4gICAgICAgICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoJ2luLXZpZXcnKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgd2luZG93Lm9uc2Nyb2xsID0gZnVuY3Rpb24gZGV0ZWN0U2Nyb2xsKGUpIHtcbiAgICAgICAgaWYoc2Nyb2xsVGltZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHNjcm9sbFRpbWVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHNjcm9sbENhY2hlVGltZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHNjcm9sbENhY2hlVGltZXIpO1xuICAgICAgICB9IFxuXG4gICAgICAgIGlmKGNhY2hlU2Nyb2xsUG9zIDwgd2luZG93LnNjcm9sbFkpIHtcbiAgICAgICAgICAgIC8vc2Nyb2xsaW5nIGRvd24gXG4gICAgICAgICAgICBtZW51YmFyLmNsYXNzTGlzdC5hZGQoJ2hpZGUtbmF2Jyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYoY2FjaGVTY3JvbGxQb3MgPiB3aW5kb3cuc2Nyb2xsWSkge1xuICAgICAgICAgICAgLy9zY3JvbGxpbmcgdXBcbiAgICAgICAgICAgIG1lbnViYXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZS1uYXYnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjcm9sbFRpbWVyID0gc2V0VGltZW91dChoYW5kbGVTY3JvbGwsIDE1MDApO1xuICAgICAgICBzY3JvbGxDYWNoZVRpbWVyID0gc2V0VGltZW91dChzY3JvbGxTZXRDYWNoZWQsIDEwMCk7XG5cbiAgICAgICAgaWYod2luZG93LnNjcm9sbFkgPT0gMCkgeyBtYXN0aGVhZC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBpbml0aWFsQkdDb2xvcjsgfSBcbiAgICAgICAgaWYod2luZG93LnNjcm9sbFkgPiAwICYmIHdpbmRvdy5zY3JvbGxZIDw9IDIwKSB7IG1hc3RoZWFkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJHQ29sb3JfMTsgfVxuICAgICAgICBpZih3aW5kb3cuc2Nyb2xsWSA+PSAyMSAmJiB3aW5kb3cuc2Nyb2xsWSA8PSA0MCkgeyBtYXN0aGVhZC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiR0NvbG9yXzI7IH1cbiAgICAgICAgaWYod2luZG93LnNjcm9sbFkgPj0gNDEgJiYgd2luZG93LnNjcm9sbFkgPD0gNjApIHsgbWFzdGhlYWQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYkdDb2xvcl8zOyB9XG4gICAgICAgIGlmKHdpbmRvdy5zY3JvbGxZID49IDYxICYmIHdpbmRvdy5zY3JvbGxZIDw9IDgwKSB7IG1hc3RoZWFkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJHQ29sb3JfNDsgfVxuICAgICAgICBpZih3aW5kb3cuc2Nyb2xsWSA+PSA4MSAmJiB3aW5kb3cuc2Nyb2xsWSA8PSAxMDApIHsgbWFzdGhlYWQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYkdDb2xvcl81OyB9XG4gICAgICAgIGlmKHdpbmRvdy5zY3JvbGxZID49IDEwMSAmJiB3aW5kb3cuc2Nyb2xsWSA8PSAxMjApIHsgbWFzdGhlYWQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYkdDb2xvcl82OyB9XG4gICAgICAgIGlmKHdpbmRvdy5zY3JvbGxZID49IDEyMSkgeyBtYXN0aGVhZC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBpbml0aWFsQkdDb2xvcjsgfVxuXG4gICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgICAgaXNFbGVtZW50VmlzaWJsZShlbGVtKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxufSkod2luZG93KTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIEZ1bmN0aW9uIHRvIGFuaW1hdGUgdGhlIHNjcm9sbFxuICAgIHZhciBzbW9vdGhTY3JvbGwgPSBmdW5jdGlvbihhbmNob3IsIGR1cmF0aW9uLCBvZmZzZXQpIHtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGhvdyBmYXIgYW5kIGhvdyBmYXN0IHRvIHNjcm9sbFxuICAgICAgdmFyIHN0YXJ0TG9jYXRpb24gPSB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICB2YXIgZW5kTG9jYXRpb24gPSBhbmNob3Iub2Zmc2V0VG9wO1xuICAgICAgdmFyIGRpc3RhbmNlID0gZW5kTG9jYXRpb24gLSBzdGFydExvY2F0aW9uO1xuICAgICAgdmFyIGluY3JlbWVudHMgPSBkaXN0YW5jZSAvIChkdXJhdGlvbiAvIDE2KTtcbiAgICAgIHZhciBzdG9wQW5pbWF0aW9uLCBydW5BbmltYXRpb24sIHRyYXZlbGxlZDtcblxuICAgICAgaWYob2Zmc2V0ID4gMCkge1xuICAgICAgICBlbmRMb2NhdGlvbiA9IGVuZExvY2F0aW9uIC0gb2Zmc2V0O1xuICAgICAgfVxuXG4gICAgICAvLyBTY3JvbGwgdGhlIHBhZ2UgYnkgYW4gaW5jcmVtZW50LCBhbmQgY2hlY2sgaWYgaXQncyB0aW1lIHRvIHN0b3BcbiAgICAgIHZhciBhbmltYXRlU2Nyb2xsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHdpbmRvdy5zY3JvbGxCeSgwLCBpbmNyZW1lbnRzKTtcbiAgICAgICAgdHJhdmVsbGVkID0gd2luZG93LnBhZ2VZT2Zmc2V0O1xuXG4gICAgICAgIHJ1bkFuaW1hdGlvbiA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlU2Nyb2xsKTtcblxuICAgICAgICAvLyBJZiBzY3JvbGxpbmcgZG93blxuICAgICAgICAgIGlmIChpbmNyZW1lbnRzID49IDApIHtcbiAgICAgICAgICAgIC8vIFN0b3AgYW5pbWF0aW9uIHdoZW4geW91IHJlYWNoIHRoZSBhbmNob3IgT1IgdGhlIGJvdHRvbSBvZiB0aGUgcGFnZVxuICAgICAgICAgICAgICBpZiAoKHRyYXZlbGxlZCA+PSAoZW5kTG9jYXRpb24gLSBpbmNyZW1lbnRzKSkgfHwgKCh3aW5kb3cuaW5uZXJIZWlnaHQgKyB0cmF2ZWxsZWQpID49IGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0KSkge1xuICAgICAgICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHJ1bkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gSWYgc2Nyb2xsaW5nIHVwXG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBTdG9wIGFuaW1hdGlvbiB3aGVuIHlvdSByZWFjaCB0aGUgYW5jaG9yIE9SIHRoZSB0b3Agb2YgdGhlIHBhZ2VcbiAgICAgICAgICAgICAgaWYgKHRyYXZlbGxlZCA8PSAoZW5kTG9jYXRpb24gfHwgMCkpIHtcbiAgICAgICAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShydW5BbmltYXRpb24pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLy8gTG9vcCB0aGUgYW5pbWF0aW9uIGZ1bmN0aW9uXG4gICAgICBydW5BbmltYXRpb24gPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZVNjcm9sbCk7XG5cbiAgICB9O1xuXG4gICAgLy8gV2hlbiB0aGUgc21vb3RoIHNjcm9sbCBsaW5rIGlzIGNsaWNrZWRcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAvLyBldmVudCBkZWxlZ2F0aW9uXG4gICAgaWYoZS50YXJnZXQgJiYgZS50YXJnZXQubm9kZU5hbWUgPT0gJ0EnKSB7XG4gICAgICAgIGlmKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2Nyb2xsJykpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgLy8gR2V0IGFuY2hvciBsaW5rIGFuZCBjYWxjdWxhdGUgZGlzdGFuY2UgZnJvbSB0aGUgdG9wXG4gICAgICAgICAgICB2YXIgZGF0YUlEID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgICAgICAgICB2YXIgZGF0YVRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YUlEKTtcbiAgICAgICAgICAgIHZhciBkYXRhU3BlZWQgPSAoZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXNjcm9sbC1zcGVlZCcpKSA/IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1zY3JvbGwtc3BlZWQnKSA6IDUwMDtcbiAgICAgICAgICAgIHZhciBkYXRhT2Zmc2V0ID0gKGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1zY3JvbGwtb2Zmc2V0JykpID8gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXNjcm9sbC1vZmZzZXQnKSA6IGZhbHNlO1xuXG4gICAgICAgICAgICAvLyBJZiB0aGUgYW5jaG9yIGV4aXN0c1xuICAgICAgICAgICAgaWYgKGRhdGFUYXJnZXQpIHtcbiAgICAgICAgICAgICAgLy8gU2Nyb2xsIHRvIHRoZSBhbmNob3JcbiAgICAgICAgICAgICAgc21vb3RoU2Nyb2xsKGRhdGFUYXJnZXQsIGRhdGFTcGVlZCwgZGF0YU9mZnNldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB9LCBmYWxzZSk7XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=